@page "/recipes"
@using TheStockedKitchen.Client;
@using TheStockedKitchen.Web.Shared.Components;

@inject ITheStockedKitchenClient _apiClient

<MudGrid>
    <MudItem xs="11">
        <MudText Class="site-logo-text site-title-large" Typo="Typo.overline" Align="Align.Center" Color="Color.Primary">Recipes</MudText>
    </MudItem>
    @if(ShowRecipeDetail)
    {
        <MudItem xs="1">
            <MudFab Color="Color.Primary" StartIcon="@Icons.Material.Filled.ArrowBack" OnClick="HideShowRecipeDetail" />
        </MudItem>
    }
</MudGrid>
@if (Loading)
{
    <LoadingSpinner />
}
else
{
    @if(ShowRecipeDetail)
    {
        <RecipeDetail RecipeVM="SelectedRecipeVM" FoodStocks="FoodStocks" />
    }
    else
    {
        <RecipeSearch ViewRecipeEvent="OpenRecipeDetail" FoodStocks="FoodStocks" />
    }
}

@code {
    private List<FoodStock> FoodStocks { get; set; } = new List<FoodStock>();
    private RecipeVM SelectedRecipeVM { get; set; } = new RecipeVM();
    private bool ShowRecipeDetail { get; set; } = false;

    private bool Loading { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Loading = true;

        FoodStocks = (await _apiClient.GetFoodStockAsync()).ToList();

        Loading = false;
    }

    private void OpenRecipeDetail(RecipeVM recipeVM)
    {
        SelectedRecipeVM = recipeVM;
        ShowRecipeDetail = true;
    }

    private void HideShowRecipeDetail()
    {
        ShowRecipeDetail = false;
    }
}